# Dev Log: Branching Setup and Verification

**Version:** v0.4
**Date:** 2026-02-28

## What Happened in This Session

### Task 1: Branching Strategy and Setup Approach
**Question:** What's the smartest way to set up main/dev? Make current version dev or keep as main?
**Answer:** Keep `main` as `main`. Create `dev` from it. Reasons: Streamlit Cloud already deploys from main; GitHub default is main; no deployment reconfiguration needed.
**Decision:** One-time setup: tag v0.4 on main → create dev from main → push dev to origin. Work on dev going forward.

### Task 2: Branching Guide Documentation
**Question:** Need a reference doc for commit, push, merge without making mistakes.
**Answer/Solution:** Created `docs/BRANCHING-GUIDE.md` with:
- Branch roles (main = production, dev = workbench)
- One-time setup commands
- Daily workflow (start on dev, commit, push to dev)
- Merging via PR (dev → main)
- Tagging releases on main
- Quick reference table (which commands are safe where)
- Emergency hotfix flow
- Common mistakes and recovery
- Optional branch protection on GitHub
- Streamlit Cloud integration (production deploys from main)
- Optional: Staging app setup (second Streamlit Cloud app deploying from dev, for cloud testing when needed)
**Files modified:** `docs/BRANCHING-GUIDE.md` (new), `docs/DOCUMENTATION-GUIDE.md` (project structure, workflow), `README.md` (project structure)

### Task 3: Error Logging and Testing from Dev
**Question:** (1) No error logging system — need to build it. (2) How to test from dev when Streamlit Cloud deploys from main?
**Answer:**
- **Error logging:** Acknowledged as a gap (noted in iteration doc). Can build in v0.5 on dev. Not a blocker for branching.
- **Testing from dev:** Two layers — (1) Local: `streamlit run streamlit_app.py`, CLI, integration tests on dev branch — covers most cases. (2) Optional cloud: Create a staging app on Streamlit Community Cloud that deploys from `dev` — same repo, different branch, same secrets. Use when changing secrets, dependencies, or Streamlit-specific behavior.
**Decision:** Local testing is primary. Staging app is optional "when needed" (e.g., cloud-specific issues, dependency changes).

### Task 4: Staging App Instructions
**Question:** Add staging app setup to branching guide.
**Answer/Solution:** Added full section: two-app setup (production + staging), one-time setup steps (same repo, branch = dev, same secrets), testing workflow, when staging matters most.
**Files modified:** `docs/BRANCHING-GUIDE.md`

### Task 5: Branch Setup Verification
**Question:** Confirm branching is set up correctly.
**Verification result:** All good ✓
- `main` and `dev` both exist locally and on `origin`
- Both point to same commit (`78c8535` — v0.4: Add branching guide + docs update)
- Tag `v0.4` exists and points to that commit
- Currently on `dev`, up to date with origin
- Working tree clean

## Key Decisions Made

1. main stays main; dev created from main — no renaming
2. Merge dev → main via PR only (documented merge history)
3. Tag releases on main after each merge
4. Staging app is optional — set up when cloud-specific testing is needed
5. Error logging deferred to v0.5

## Related Files

- [docs/BRANCHING-GUIDE.md](../BRANCHING-GUIDE.md) — Full branching reference
- [docs/iterations/v0.4-supabase-langfuse-tracking.md](../iterations/v0.4-supabase-langfuse-tracking.md) — Current version
- [docs/DOCUMENTATION-GUIDE.md](../DOCUMENTATION-GUIDE.md) — Updated workflow (commit to dev)
